import urllib.parse
import requests
import statistics
from multiprocessing import Pool
from pathlib import Path
from tensorboard.backend.event_processing import event_accumulator
import matplotlib.pyplot as plt
import seaborn as sns


def visualize_f1_over_epoch(values):
    sns.set(style="darkgrid")
    plt.figure(figsize=(8, 5))

    for dir, res in sorted(values, key=lambda x: x[0]):
        sns.lineplot(x=res[0], y=res[1], label=dir)

    plt.xlabel("Step")
    plt.ylabel("F1-score")
    ax = plt.gca()
    ax.set_ylim([0, 1.1])
    ax.axhline(y=1.0, linewidth=1, color="k", ls="--")

    plt.show()
    # plt.savefig(f"{p.name}-{scalar}.png")


if __name__ == "__main__":

    # 0.5
    mnist = {
        "0.5": [
            (
                "fedad",
                (
                    (114, 229, 344, 459, 574, 689, 804, 919, 1034, 1149),
                    (
                        0.20319999754428864,
                        0.3813999891281128,
                        0.6833999752998352,
                        0.7523999810218811,
                        0.8482999801635742,
                        0.857200026512146,
                        0.8934000134468079,
                        0.9063000082969666,
                        0.9045000076293945,
                        0.9276999831199646,
                    ),
                ),
            )
        ],
        "0.3": [
            (
                "fedad",
                (
                    (114, 229, 344, 459, 574, 689, 804, 919, 1034, 1149),
                    (
                        0.26980000734329224,
                        0.4341999888420105,
                        0.551800012588501,
                        0.784500002861023,
                        0.8274000287055969,
                        0.8795999884605408,
                        0.8755000233650208,
                        0.9067000150680542,
                        0.8992999792098999,
                        0.9233999848365784,
                    ),
                ),
            ),
        ],
        "0.05": [
            (
                "fedad",
                (
                    (114, 229, 344, 459, 574, 689, 804, 919, 1034, 1149),
                    (
                        0.21369999647140503,
                        0.40290001034736633,
                        0.45339998602867126,
                        0.546500027179718,
                        0.6308000087738037,
                        0.6690000295639038,
                        0.671999990940094,
                        0.7050999999046326,
                        0.6819999814033508,
                        0.7095000147819519,
                    ),
                ),
            ),
        ],
        "0.03": [
            (
                "fedad",
                (
                    (114, 229, 344, 459, 574, 689, 804, 919, 1034, 1149),
                    (
                        0.23420000076293945,
                        0.34220001101493835,
                        0.4814000129699707,
                        0.5684999823570251,
                        0.6370999813079834,
                        0.6550999879837036,
                        0.6554999947547913,
                        0.7235000133514404,
                        0.7196000218391418,
                        0.7257000207901001,
                    ),
                ),
            ),
        ],
    }

    fmnist = {"0.5": [], "0.3": [], "0.05": [], "0.03": []}

    cifar10 = {
        "0.5": [
            (
                "fedad",
                (
                    (78, 157, 236, 315, 394, 473, 552, 631, 710, 789),
                    (
                        0.15929999947547913,
                        0.20309999585151672,
                        0.2371000051498413,
                        0.23980000615119934,
                        0.3181999921798706,
                        0.3716999888420105,
                        0.3846000134944916,
                        0.4246000051498413,
                        0.41499999165534973,
                        0.45399999618530273,
                    ),
                ),
            ),
        ],
        "0.3": [
            (
                "fedad",
                (
                    (78, 157, 236, 315, 394, 473, 552, 631, 710, 789),
                    (
                        0.17910000681877136,
                        0.2321999967098236,
                        0.26649999618530273,
                        0.29789999127388,
                        0.3287999927997589,
                        0.31290000677108765,
                        0.33799999952316284,
                        0.3894999921321869,
                        0.3517000079154968,
                        0.4300000071525574,
                    ),
                ),
            )
        ],
        "0.05": [
            (
                "fedad",
                (
                    (78, 157, 236, 315, 394, 473, 552, 631, 710, 789),
                    (
                        0.1687999963760376,
                        0.16820000112056732,
                        0.2037000060081482,
                        0.2101999968290329,
                        0.23090000450611115,
                        0.25380000472068787,
                        0.27219998836517334,
                        0.2874000072479248,
                        0.257999986410141,
                        0.2946000099182129,
                    ),
                ),
            )
        ],
        "0.03": [
            (
                "fedad",
                (
                    (78, 157, 236, 315, 394, 473, 552, 631, 710, 789),
                    (
                        0.10000000149011612,
                        0.11800000071525574,
                        0.12600000202655792,
                        0.18039999902248383,
                        0.2029999941587448,
                        0.20430000126361847,
                        0.22519999742507935,
                        0.24889999628067017,
                        0.24709999561309814,
                        0.2906000018119812,
                    ),
                ),
            )
        ],
    }
